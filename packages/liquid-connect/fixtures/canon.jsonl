{"id":"s0-001","stage":0,"query":"Q @revenue","type":"metric","description":"Total revenue","ast":{"kind":"Query","type":"metric","metrics":[{"kind":"Metric","name":"revenue"}]},"sql_duckdb":"SELECT SUM(unit_price * quantity * (1 - discount)) AS revenue FROM order_details","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s0-002","stage":0,"query":"Q @orders","type":"metric","description":"Order count","ast":{"kind":"Query","type":"metric","metrics":[{"kind":"Metric","name":"orders"}]},"sql_duckdb":"SELECT COUNT(DISTINCT order_id) AS orders FROM orders","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s0-003","stage":0,"query":"Q @customers","type":"metric","description":"Customer count","ast":{"kind":"Query","type":"metric","metrics":[{"kind":"Metric","name":"customers"}]},"sql_duckdb":"SELECT COUNT(DISTINCT customer_id) AS customers FROM customers","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s0-004","stage":0,"query":"Q .customers","type":"entity","description":"List customers","ast":{"kind":"Query","type":"entity","entity":{"kind":"Entity","name":"customers"}},"sql_duckdb":"SELECT customer_id, company_name, contact_name, country FROM customers","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s0-005","stage":0,"query":"Q .orders","type":"entity","description":"List orders","ast":{"kind":"Query","type":"entity","entity":{"kind":"Entity","name":"orders"}},"sql_duckdb":"SELECT order_id, customer_id, order_date, ship_country FROM orders","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s0-006","stage":0,"query":"Q .products","type":"entity","description":"List products","ast":{"kind":"Query","type":"entity","entity":{"kind":"Entity","name":"products"}},"sql_duckdb":"SELECT product_id, product_name, unit_price, discontinued FROM products","status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s1-001","stage":1,"query":"Q @orders #country","type":"metric+dimension","description":"Orders by country","sql":"SELECT ship_country AS \"country\", COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" GROUP BY ship_country","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s2-001","stage":2,"query":"Q @orders ?usa","type":"metric+filter","description":"US orders only","sql":"SELECT COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" WHERE ship_country = 'USA'","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s2-002","stage":2,"query":"Q @orders #country ?usa","type":"metric+dimension+filter","description":"US orders by country","sql":"SELECT ship_country AS \"country\", COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" WHERE ship_country = 'USA' GROUP BY ship_country","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s3-001","stage":3,"query":"Q @orders ~P30d","type":"metric+time","description":"Orders last 30 days","sql":"SELECT COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" WHERE order_date >= '2024-11-28' AND order_date < '2024-12-28'","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s4-001","stage":4,"query":"Q @orders #country top:5 -@orders","type":"metric+dimension+sort+limit","description":"Top 5 countries by orders","sql":"SELECT ship_country AS \"country\", COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" GROUP BY ship_country ORDER BY orders DESC LIMIT 5","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s4-002","stage":4,"query":"Q @orders #country top:10 +#country","type":"metric+dimension+sort+limit","description":"Top 10 countries sorted alphabetically","sql":"SELECT ship_country AS \"country\", COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" GROUP BY ship_country ORDER BY country ASC LIMIT 10","parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s5-001","stage":5,"query":"Q @orders ~M vs ~M-1","type":"metric+time+compare","description":"Orders this month vs last month","parse":"success","compare":{"kind":"Compare","period":{"kind":"Period","unit":"M","offset":-1}},"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s5-002","stage":5,"query":"Q @orders ~Q vs ~Q-1","type":"metric+time+compare","description":"Orders this quarter vs last quarter","parse":"success","compare":{"kind":"Compare","period":{"kind":"Period","unit":"Q","offset":-1}},"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s5-003","stage":5,"query":"Q @orders #country ~Y vs ~Y-1","type":"metric+dimension+time+compare","description":"Orders by country this year vs last year","parse":"success","compare":{"kind":"Compare","period":{"kind":"Period","unit":"Y","offset":-1}},"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s6-001","stage":6,"query":"Q @orders #customer_country","type":"metric+dimension+join","description":"Orders by customer country (single join)","sql":"SELECT country AS \"customer_country\", COUNT(order_id) AS \"orders\" FROM \"public\".\"orders\" AS \"orders\" LEFT JOIN \"customers\" AS \"customers\" ON orders.customer_id = customers.customer_id GROUP BY country","joins":["orders->customers"],"parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s6-002","stage":6,"query":"Q @freight #customer_country","type":"metric+dimension+join","description":"Freight by customer country (single join)","sql":"SELECT country AS \"customer_country\", SUM(freight) AS \"freight\" FROM \"public\".\"orders\" AS \"orders\" LEFT JOIN \"customers\" AS \"customers\" ON orders.customer_id = customers.customer_id GROUP BY country","joins":["orders->customers"],"parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
{"id":"s6-003","stage":6,"query":"Q @revenue #category","type":"metric+dimension+join","description":"Revenue by category (multi-hop join)","sql":"SELECT category_name AS \"category\", SUM(unit_price * quantity * (1 - discount)) AS \"revenue\" FROM \"public\".\"order_details\" AS \"order_details\" LEFT JOIN \"products\" AS \"products\" ON order_details.product_id = products.product_id LEFT JOIN \"categories\" AS \"categories\" ON products.category_id = categories.category_id GROUP BY category_name","joins":["order_details->products","products->categories"],"parity":true,"status":"validated","created_at":"2025-12-28T00:00:00Z"}
