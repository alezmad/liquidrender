# ISS-049: Soft Constraints Philosophy vs. Confidence Thresholds

## Issue Summary

**Type:** Semantic Conflict
**Severity:** Medium
**Location:** Design Philosophy (§2.1) vs. Binding System (§9.3)
**Status:** RESOLVED

## Problem Statement

The specification contains a philosophical conflict:

1. **§2.1 Design Principles** states:
   - "Soft constraints, not hard filters"
   - "Suggestions score options, never block"
   - "User freedom"

2. **§9.3 Confidence Thresholds** defines:
   ```
   Score    Behavior
   > 0.8    Auto-bind (high confidence)
   0.5-0.8  Bind with "best guess" flag
   < 0.5    Prompt for clarification
   ```

**The Conflict:** If soft constraints "never block," why does a score < 0.5 trigger a prompt (blocking user flow)? The thresholds appear to be hard decision boundaries, contradicting the soft philosophy.

## Analysis

### Current State

The specification uses "soft constraints" in two different contexts:

1. **Data-level constraints** (what the issue is about):
   - Binding suggestions based on field types, semantics, patterns
   - Threshold-based decision making (§9.3)

2. **User-level constraints** (what "never block" means):
   - User can always override system suggestions
   - No validation that rejects user intent
   - System never refuses to generate an interface

### Root Cause

The term "soft constraint" is **overloaded** and used imprecisely. The philosophy applies to *user decisions*, not *system automation heuristics*.

### Semantic Confusion

| What People Think "Soft Constraints" Means | What It Actually Means in LiquidCode |
|---------------------------------------------|-------------------------------------|
| System never makes decisions | System makes probabilistic suggestions |
| All thresholds are advisory | Thresholds guide automation, not user choice |
| User must confirm everything | User only intervenes on low confidence |
| No automatic binding | Automatic binding when confidence is high |

## Resolution

### Decision

**CLARIFY THE PHILOSOPHY** - The "soft constraints" principle is about user agency, not system passivity.

### Revised Language

Replace the "Soft constraints, not hard filters" row in §2.1 with:

```markdown
| Principle | Meaning | Implication |
|-----------|---------|-------------|
| **Suggestions, not restrictions** | System proposes, user disposes | User can override any system decision |
```

And add this clarification immediately after the table in §2.1:

```markdown
### 2.1.1 Soft Constraints Explained

**What "soft constraints" means:**
- The system **suggests** bindings, layouts, and types based on confidence scores
- Confidence thresholds guide **automation**, not **validation**
- Low confidence triggers **clarification**, not **rejection**
- Users can **always override** any system decision

**What "soft constraints" does NOT mean:**
- The system makes no automated decisions (it does, when confident)
- All suggestions require user confirmation (only low-confidence ones do)
- There are no thresholds (there are, for guiding system behavior)

**The principle:** Thresholds determine *when to ask*, not *whether to allow*.

| Confidence | System Behavior | User Freedom |
|------------|-----------------|--------------|
| High (>0.8) | Auto-bind, proceed | User can edit/override afterward |
| Medium (0.5-0.8) | Auto-bind with flag | User warned this is a guess |
| Low (<0.5) | Ask for input | User provides guidance |
| Zero (explicit user choice) | Use exactly what user specified | System doesn't question |

**Critical invariant:** User explicit intent (level zero) always overrides any confidence score.
```

### Update §9.3 to Align

In §9.3 "Confidence Thresholds", change the heading to:

```markdown
### 9.3 Automation Thresholds
```

And add this preamble:

```markdown
These thresholds guide **when the system automates** vs. **when it asks for input**.
They are not validation gates—users can always override system decisions.
```

Update the table:

```markdown
| Score | System Behavior | User Can Override? |
|-------|-----------------|-------------------|
| > 0.8 | Auto-bind (high confidence) | ✅ Yes, at any time |
| 0.5 - 0.8 | Auto-bind with "best guess" indicator | ✅ Yes, indicator prompts review |
| < 0.5 | Request user clarification | ✅ Yes, can pick any field |
| User-specified | Use exact binding | N/A (user already decided) |
```

### Update B.5.4 Coherence Thresholds

In Appendix B.5.4, change the table heading to:

```markdown
#### B.5.4 Coherence Action Thresholds

These thresholds determine reuse strategy, not acceptance criteria.
```

And clarify:

```markdown
| Confidence | Automated Action | Reason |
|------------|------------------|--------|
| ≥ 0.9 | Accept fragment directly | Very high match probability |
| 0.7 - 0.9 | Accept with micro-LLM repairs | Good match, minor fixes needed |
| 0.5 - 0.7 | Escalate to composition tier | Fragment mismatch, compose instead |
| < 0.5 | Escalate to LLM tier | Novel pattern, generate fresh |

**Note:** These guide the resolution system's tier selection. They do not block user-initiated generation.
```

## Verification

### Philosophy Consistency Check

After changes, verify these statements are true:

- ✅ User can always override any binding suggestion
- ✅ System automates when confident, asks when uncertain
- ✅ Thresholds guide system behavior, not user permissions
- ✅ "Soft constraints" means user agency, not system passivity
- ✅ Low confidence prompts for input, doesn't reject

### Terminology Consistency

Ensure these terms are used consistently:

| Term | Meaning | Use For |
|------|---------|---------|
| **Soft constraint** | User can override | Binding suggestions, layout hints |
| **Hard constraint** | System enforces | Schema validation, type safety |
| **Threshold** | Automation decision point | When to auto-bind vs. ask |
| **Confidence score** | Match probability | How sure system is about a suggestion |
| **Validation** | Schema correctness check | Zod validation, type checking |

## Impact Assessment

**Sections Modified:**
- §2.1 - Clarified philosophy with new subsection
- §9.3 - Renamed to "Automation Thresholds" with clarifications
- §B.5.4 - Renamed to "Coherence Action Thresholds" with context

**Breaking Changes:** None - this is a documentation clarification

**Conceptual Changes:**
- Clearer distinction between system automation heuristics and user validation
- Explicit statement that thresholds guide *when to ask*, not *whether to allow*

## Examples

### Before (Confusing)

> "Soft constraints, not hard filters — Suggestions score options, never block"

**Reader interpretation:** System makes no automated decisions, everything requires user input.

### After (Clear)

> "Suggestions, not restrictions — System proposes, user disposes. Thresholds guide automation (when to auto-bind vs. ask), not validation (user can always override)."

**Reader interpretation:** System automates confidently, asks when unsure, but user always has final say.

## Sign-off

- [x] Philosophy clarified
- [x] Terminology aligned across sections
- [x] Thresholds reframed as automation guidance
- [x] User agency preserved and emphasized
- [x] No breaking changes

---

**Resolved By:** LiquidCode Analysis Team
**Date:** 2025-12-21
**Resolution Type:** Documentation Clarification
