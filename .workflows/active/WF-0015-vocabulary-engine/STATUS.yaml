id: WF-0015
name: Knosia Vocabulary Engine
status: completed
created: 2025-12-29
completed: 2025-12-29
objective: API module + onboarding UI for vocabulary extraction

checkpoint:
  tag: WF-0015-start
  commit: 4cb09a7

waves:
  - id: wave-0
    name: Bootstrap
    status: completed
    tasks:
      - id: 0.1
        name: Database schema for vocabularies
        status: completed
        artifact: packages/db/src/schema/vocabulary.ts
      - id: 0.2
        name: Zod validation schemas
        status: completed
        artifact: packages/api/src/modules/vocabulary/schema.ts
      - id: 0.3
        name: Run migration
        status: completed

  - id: wave-1
    name: API Module
    status: completed
    parallel: true
    tasks:
      - id: 1.1
        name: Router with extract/validate/save endpoints
        status: completed
        artifact: packages/api/src/modules/vocabulary/router.ts
      - id: 1.2
        name: Queries (getVocabulary, listVocabularies)
        status: completed
        artifact: packages/api/src/modules/vocabulary/queries.ts
      - id: 1.3
        name: Mutations (createVocabulary, updateVocabulary)
        status: completed
        artifact: packages/api/src/modules/vocabulary/mutations.ts

  - id: wave-2
    name: Onboarding UI
    status: completed
    parallel: true
    tasks:
      - id: 2.1
        name: Connect step (database connection form)
        status: completed
        artifact: apps/web/src/modules/vocabulary/components/steps/connect-step.tsx
      - id: 2.2
        name: Review step (DataTables for entities/metrics)
        status: completed
        artifact: apps/web/src/modules/vocabulary/components/steps/review-step.tsx
      - id: 2.3
        name: Confirm step (5-10 confirmation questions)
        status: completed
        artifact: apps/web/src/modules/vocabulary/components/steps/confirm-step.tsx
      - id: 2.4
        name: Save step (save and download)
        status: completed
        artifact: apps/web/src/modules/vocabulary/components/steps/save-step.tsx

  - id: wave-3
    name: Integration
    status: completed
    tasks:
      - id: 3.1
        name: Wire vocabulary routes to main router
        status: completed
        artifact: apps/web/src/app/[locale]/dashboard/(user)/vocabulary/page.tsx
      - id: 3.2
        name: Add sidebar navigation item
        status: completed
        artifact: apps/web/src/app/[locale]/dashboard/(user)/layout.tsx
      - id: 3.3
        name: Integration test
        status: completed
        notes: API tests pass (21/21), typecheck passes

artifacts:
  - .claude/artifacts/2025-12-29-0149-vocabulary-engine-architecture.md
  - .cognitive/sessions/knosia-vocabulary.md
  - packages/liquid-connect/src/uvb/
  - packages/db/src/schema/vocabulary.ts
  - packages/api/src/modules/vocabulary/
  - apps/web/src/modules/vocabulary/

references:
  - packages/api/src/modules/admin/users/ (API pattern)
  - packages/api/src/index.ts (router wiring)
