# Knosia Consolidated Implementation Plan

**Date:** 2026-01-02
**Status:** Source of Truth
**Version:** 1.0
**Timeline Reference:** See [1700-knosia-project-structure.md](.artifacts/2026-01-02-1700-knosia-project-structure.md) for file counts and structure details

---

## Executive Summary

Knosia transforms raw business data into actionable knowledge. This document consolidates the implementation plan, UX specification, and technical architecture into a single source of truth.

**Core Value Proposition:**
> Connect your database, and within 60 seconds you have a personalized briefing, vocabulary that speaks your language, and AI that understands your business.

**Key Insight:** 90% of the infrastructure is already built. We need glue code to connect existing systems.

**LOC Estimates:**
- **Core glue layer:** ~700 LOC (UVBâ†’DB, Vocabâ†’SemanticLayer, Templateâ†’Dashboard)
- **Full integration layer:** ~1,250 LOC (includes business type detection, template catalog)
- **Complete implementation:** ~2,650 LOC (includes UI pages, onboarding enhancements, canvas integration)

---

## Table of Contents

1. [Architecture Overview](#1-architecture-overview)
2. [What's Already Built](#2-whats-already-built)
3. [What We Need to Build](#3-what-we-need-to-build)
4. [Integration Architecture](#4-integration-architecture)
5. [UX Specification](#5-ux-specification)
6. [Implementation Phases](#6-implementation-phases)
7. [Technical Specifications](#7-technical-specifications)
8. [File Locations](#8-file-locations)

---

## 1. Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           KNOSIA ARCHITECTURE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  LIQUID-CONNECT (Data Layer) âœ… BUILT                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ UVB: Schema extraction + Hard rules                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Query Engine: NL â†’ LC DSL                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Compiler: LC DSL â†’ AST â†’ LiquidFlow                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Semantic Layer + Registry                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Resolver: AST â†’ IR                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Emitters: PostgreSQL, DuckDB, Trino                                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Executor: SQL execution + Provenance                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  LIQUID-RENDER (UI Layer) âœ… BUILT                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ UI Compiler: parseUI(), compileUI(), roundtripUI()                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ LiquidUI: Schema â†’ React components                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ 77 component types (charts, forms, tables, etc.)                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Theme system (default, turbostarter)                                â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Demo at /demo/liquid-render                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  VOCABULARY SYSTEM âœ… BUILT                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ 3-level hierarchy: Org â†’ Workspace â†’ User                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Resolution algorithm: Private > Workspace > Org                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ API: CRUD, preferences, private vocab, suggestions                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ UI: VocabularyBrowser, VocabularyCard                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CANVAS & COLLABORATION âœ… BUILT                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Canvas API (canvas/, comment/, activity/)                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Thread system (thread/ API module)                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Notification system (notification/, insight/, digest)               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Search API (search/)                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  KNOSIA INTEGRATION ğŸ†• TO BUILD (~1,250 LOC)                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Business type detection                                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Template catalog (SaaS, E-commerce, Marketplace, Custom)            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Glue: UVB â†’ Vocabulary DB                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Glue: Vocabulary â†’ SemanticLayer                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Dashboard spec generator                                            â”‚   â”‚
â”‚  â”‚  â””â”€â”€ UI Pages (Onboarding enhancements, HOME integration)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. What's Already Built

### 2.1 LiquidConnect (packages/liquid-connect)

| Module | Status | Description |
|--------|--------|-------------|
| **UVB** | âœ… | Schema extraction, hard rules, adapters (PostgreSQL, DuckDB) |
| **Compiler** | âœ… | Scanner, parser, AST, diagnostics |
| **LiquidFlow** | âœ… | IR builder, validation, serialization |
| **Semantic Layer** | âœ… | Registry, YAML loader, validation |
| **Resolver** | âœ… | AST â†’ LiquidFlow resolution |
| **Emitters** | âœ… | PostgreSQL, DuckDB, Trino SQL generation |
| **Executor** | âœ… | Query execution, provenance, timeout |
| **Query Engine** | âœ… | NL â†’ LC DSL (normalizer, matcher, engine) |
| **Vocabulary** | âœ… | Patterns, synonyms, compiler |
| **Pipeline** | âœ… | End-to-end integration (pipeline/index.ts) |

**Subpath Import:** UVB can be imported via `@repo/liquid-connect/uvb` for direct access.

### 2.2 LiquidRender (packages/liquid-render)

| Module | Status | Description |
|--------|--------|-------------|
| **UI Compiler** | âœ… | parseUI, compileUI, roundtripUI |
| **LiquidUI** | âœ… | Schema â†’ React rendering |
| **Components** | âœ… | 77 types (charts, forms, tables, layout) |
| **Themes** | âœ… | Default, TurboStarter themes |
| **Data Context** | âœ… | Binding resolution |
| **Manifest** | âœ… | Component intelligence layer |

**BLOCK_TYPE_TO_LIQUID_TYPE Delegation:** Dashboard blocks map to LiquidRender component types via this pattern (see schema-generator.ts).

### 2.3 Knosia API (packages/api/src/modules/knosia)

| Module | Status | Endpoint | Description |
|--------|--------|----------|-------------|
| **Connections** | âœ… | `/connections` | CRUD, test connection |
| **Analysis** | âœ… | `/analysis` | SSE streaming analysis |
| **Vocabulary** | âœ… | `/vocabulary` | Full CRUD, preferences, private vocab |
| **Briefing** | âœ… | `/briefing` | Basic structure |
| **Thread** | âœ… | `/thread` | Query, clarify (formerly "conversation") |
| **Activity** | âœ… | `/activity` | Activity tracking |
| **Canvas** | âœ… | `/canvas` | Canvas management |
| **Comment** | âœ… | `/comment` | Comments on blocks |
| **Insight** | âœ… | `/insight` | AI-generated insights |
| **Notification** | âœ… | `/notification` | User notifications |
| **Search** | âœ… | `/search` | Unified search |

**Note:** All "conversation" references have been renamed to "thread" in implementation.

### 2.4 Knosia Database (packages/db/schema/knosia.ts)

**26 tables (V1 complete)**

#### Platform
- `knosia_organization` - Org with guest TTL

#### Workspace
- `knosia_workspace` - Bounded context
- `knosia_workspace_connection` - Workspace-connection mapping

#### Connection
- `knosia_connection` - Database credentials
- `knosia_connection_health` - Status tracking
- `knosia_connection_schema` - Cached schema snapshot

#### Vocabulary
- `knosia_vocabulary_item` - 3-level vocabulary (org/workspace/user via scope)
- `knosia_vocabulary_version` - Version history
- `knosia_user_vocabulary_prefs` - User preferences (favorites, synonyms, private vocabulary)

#### Role
- `knosia_role_template` - Cognitive profiles

#### User
- `knosia_workspace_membership` - User-workspace association
- `knosia_user_preference` - User preferences

#### Intelligence
- `knosia_analysis` - Schema analysis runs
- `knosia_thread` - Chat sessions (formerly "conversation")
- `knosia_thread_message` - Messages in threads

#### Canvas
- `knosia_canvas` - Canvas definitions
- `knosia_canvas_block` - Blocks within canvases
- `knosia_canvas_layout` - Layout configuration

#### Collaboration
- `knosia_comment` - Comments on blocks/canvases
- `knosia_activity` - Activity stream

#### Notification System
- `knosia_notification` - User notifications
- `knosia_digest` - Digest preferences
- `knosia_ai_insight` - AI-generated insights

#### Governance
- `knosia_mismatch_report` - User-reported issues

---

## 3. What We Need to Build

### 3.1 Glue Code (~700 LOC - Core Integration)

| Function | Purpose | LOC |
|----------|---------|-----|
| `saveDetectedVocabulary()` | UVB output â†’ DB rows | ~100 |
| `generateSemanticLayerForUser()` | ResolvedVocab â†’ SemanticLayer | ~150 |
| `detectBusinessType()` | Schema patterns â†’ business type | ~200 |
| `generateDashboardSpec()` | Template + KPIs â†’ DashboardSpec | ~150 |
| `dashboardSpecToLiquidSchema()` | DashboardSpec â†’ LiquidSchema | ~100 |

### 3.2 Business Type System (~500 LOC - Full Layer)

| Component | Purpose | LOC |
|-----------|---------|-----|
| `detector.ts` | Pattern matching for business types | ~150 |
| `signatures.ts` | Detection patterns per type | ~100 |
| `catalog/saas.yaml` | SaaS KPI template | ~150 |
| `mapper.ts` | Schema â†’ template mapping | ~100 |

**V1 Scope (4 types):** SaaS, E-commerce, Marketplace, Custom
**V2 Scope (5 additional types):** Fintech, Healthcare, Edtech, Media, Logistics

**Template I/O:** `BusinessTypeTemplate` (input) â†’ `DashboardSpec` (output) via `generateDashboardSpec()`.

### 3.3 UI Pages (~1,400 LOC - Complete Implementation)

| Page | Purpose | Priority | LOC |
|------|---------|----------|-----|
| Onboarding enhancements | Business type selection, multi-connection support | P0 | ~400 |
| HOME integration | Dashboard with KPIs (Canvas exists, needs HOME route) | P0 | ~600 |
| Thread UI | Chat interface (backend ready, frontend needed) | P1 | ~400 |

**Note:** Canvas module exists but needs integration into HOME page. Mobile = responsive CSS only (no separate mobile app).

**Multi-connection Support:** `connectionIds[]` array implemented in state, `addConnection()` method available. Single `connectionId` deprecated (timeline: V1 supports both, V2 removes).

---

## 4. Integration Architecture

### 4.1 The Pipeline: Query â†’ UI (7-step end-to-end, 4 glue steps in implementation)

**7-Step End-to-End Flow:**

```
USER INPUT: "Show me MRR by month"
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: NL QUERY ENGINE                                                    â”‚
â”‚  nlQuery("Show me MRR by month", vocab) â†’ { query: "mrr by month" }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: COMPILER                                                           â”‚
â”‚  parseToAST("mrr by month") â†’ QueryNode AST                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: RESOLVER                                                           â”‚
â”‚  resolver.resolve(ast) â†’ LiquidFlow IR                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: SQL EMITTER                                                        â”‚
â”‚  emit(flow, 'postgres') â†’ SQL string                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: EXECUTOR                                                           â”‚
â”‚  executeQuery(sql, adapter) â†’ { rows: [...], provenance: {...} }            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 6: SCHEMA GENERATION (NEW GLUE - Phase 1: Direct Binding)            â”‚
â”‚  generateChartSchema('line', 'rows', 'month', 'mrr') â†’ LiquidSchema         â”‚
â”‚                                                                             â”‚
â”‚  Phase 2: Full Pipeline uses UVB â†’ Vocab â†’ SemanticLayer â†’ Dashboard       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 7: LIQUID UI                                                          â”‚
â”‚  <LiquidUI schema={schema} data={{ rows }} /> â†’ Rendered Chart              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**4 Glue Steps (Implementation Focus):**
1. UVB â†’ Vocabulary DB (`saveDetectedVocabulary`)
2. Vocabulary â†’ SemanticLayer (`generateSemanticLayerForUser`)
3. Template â†’ DashboardSpec (`generateDashboardSpec`)
4. DashboardSpec â†’ LiquidSchema (`dashboardSpecToLiquidSchema`)

### 4.2 Vocabulary 3-Level Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VOCABULARY FLOW                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  EXTRACTION (onboarding)                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  Database â†’ extractSchema() â†’ applyHardRules() â†’ DetectedVocabulary         â”‚
â”‚                                                          â”‚                  â”‚
â”‚                                                          â–¼                  â”‚
â”‚  STORAGE (3 levels)                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  knosia_vocabulary_item                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ORG LEVEL (workspaceId = NULL)                                  â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ MRR, Churn, Customer (canonical definitions)                â”‚   â”‚
â”‚  â”‚  â””â”€â”€ WORKSPACE LEVEL (workspaceId = "ws_xxx")                        â”‚   â”‚
â”‚  â”‚      â””â”€â”€ Pipeline Value, Deal Velocity (domain-specific)             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  knosia_user_vocabulary_prefs                                        â”‚   â”‚
â”‚  â”‚  â””â”€â”€ USER LEVEL (userId + workspaceId)                               â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ favorites: ["mrr", "churn"]                                 â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ synonyms: { "revenue": "mrr" }                              â”‚   â”‚
â”‚  â”‚      â””â”€â”€ privateVocabulary: [{ my_conversion: formula }]             â”‚   â”‚
â”‚  â”‚          (aggregationConfidence field tracks user override quality)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  RESOLUTION                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚  resolveVocabulary(userId, workspaceId) â†’ ResolvedVocabulary                â”‚
â”‚  Priority: PRIVATE > WORKSPACE > ORG                                        â”‚
â”‚                                                          â”‚                  â”‚
â”‚                                                          â–¼                  â”‚
â”‚  CONSUMPTION                                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                â”‚
â”‚  ResolvedVocabulary â†’ SemanticLayer â†’ Query Engine â†’ Dashboard              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Terminology:** Use "private vocabulary" consistently (not "user vocabulary").

### 4.3 Data Binding

```
LiquidSchema                              Data (from query)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{                                         {
  layers: [{                                rows: [
    root: {                                   { month: "2024-01", mrr: 125000 },
      type: "line",                           { month: "2024-02", mrr: 132000 },
      binding: {                              ...
        kind: "field",                      ]
        value: "rows",  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  }
        x: "month",     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
        y: "mrr"        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
      }
    }
  }]
}
            â”‚
            â–¼
      resolveBinding()
            â”‚
            â–¼
      LineChart renders with data points
```

---

## 5. UX Specification

### 5.1 Onboarding Flow

**Current:** Connect â†’ Test â†’ Analysis â†’ Review
**Gap:** No Summary screen (after Test), no Role selection, no Confirmation questions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ONBOARDING FLOW                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  /onboarding/connect                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Connect Your Database                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [PostgreSQL â–¼]                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Connection String:                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ postgresql://user:pass@host:5432/mydb                   â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [Test Connection]  [+ Add Another] [Continue â†’]             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼ (on success)                                 â”‚
â”‚  /onboarding/analysis                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Analyzing Your Data...                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 67%                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  âœ“ Connected to database                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  âœ“ Extracted 23 tables                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â— Detecting business type...                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ Mapping vocabulary                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ Generating dashboard                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  /onboarding/review                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  We detected: SaaS Business (94% confidence)                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Detected KPIs                          Mapped          â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  âœ“ MRR (Monthly Recurring Revenue)     subscriptions.   â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                        amount           â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  âœ“ Churn Rate                          calculated       â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  âœ“ Customer Count                      users.id         â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  âš  ARR                                 needs confirm    â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  âœ— LTV                                 insufficient     â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                        data             â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [Change Business Type]  [Confirm & Continue â†’]               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  /dashboard/[org]/home                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         (See Home Page spec below)                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Home Page (Briefing)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HOME PAGE                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€ Sidebar â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  ğŸ  Home  â”‚  â”‚  Good morning, Alex                                  â”‚   â”‚
â”‚  â”‚  ğŸ“Š Canvasâ”‚  â”‚  Here's your SaaS metrics for December 2025          â”‚   â”‚
â”‚  â”‚  ğŸ’¬ Ask   â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  ğŸ“š Vocab â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  âš™ï¸ Settingsâ”‚ â”‚  â”‚  MRR   â”‚ â”‚ Churn  â”‚ â”‚  NRR   â”‚ â”‚ Customersâ”‚       â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚$175.2K â”‚ â”‚  2.1%  â”‚ â”‚  112%  â”‚ â”‚  1,847  â”‚        â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ â–² 12%  â”‚ â”‚ â–¼ 0.3% â”‚ â”‚ â–² 5%   â”‚ â”‚ â–² 89   â”‚        â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  MRR Trend                                     â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚                                                â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  $175K â”¤                              â—â”€â”€â”€â”€    â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚        â”‚                        â—â”€â”€â”€â”€â”€         â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  $150K â”¤                  â—â”€â”€â”€â”€â”€               â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚        â”‚            â—â”€â”€â”€â”€â”€                     â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  $125K â”¤      â—â”€â”€â”€â”€â”€                           â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚        â”‚â—â”€â”€â”€â”€â”€                                 â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€ â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚              Jul    Aug    Sep    Oct    Nov   â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚                                                â”‚ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ Top Customers        â”‚ â”‚ Recent Activity      â”‚  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ Acme Corp    $12.4K  â”‚ â”‚ New: Widget Inc      â”‚  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ TechStart    $8.2K   â”‚ â”‚ Churn: OldCo         â”‚  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ DataFlow     $7.8K   â”‚ â”‚ Upgrade: FastGrow    â”‚  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Canvas Page

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CANVAS PAGE                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€ Sidebar â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           â”‚  â”‚  Canvas: Revenue Analysis              [Share] [â‹®]   â”‚   â”‚
â”‚  â”‚  ğŸ  Home  â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  ğŸ“Š Canvasâ”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚    â”” Rev  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚â”‚   â”‚
â”‚  â”‚    â”” Usersâ”‚  â”‚  â”‚  â”‚ Thread: MRR     â”‚  â”‚ Block: MRR by   â”‚       â”‚â”‚   â”‚
â”‚  â”‚    â”” Churnâ”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ Segment         â”‚       â”‚â”‚   â”‚
â”‚  â”‚  ğŸ’¬ Ask   â”‚  â”‚  â”‚  â”‚ "Show me MRR    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚â”‚   â”‚
â”‚  â”‚  ğŸ“š Vocab â”‚  â”‚  â”‚  â”‚ trend for Q4"   â”‚  â”‚ â”‚ [Bar Chart] â”‚ â”‚       â”‚â”‚   â”‚
â”‚  â”‚  âš™ï¸ Settingsâ”‚ â”‚  â”‚  â”‚                 â”‚  â”‚ â”‚             â”‚ â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ [Line Chart]    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ $150K â†’ $175K   â”‚  â”‚                 â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚                 â”‚  â”‚ Enterprise: 45% â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ Follow-up:      â”‚  â”‚ SMB: 35%        â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ [Ask about...] â”‚  â”‚ Startup: 20%    â”‚       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚                                                  â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ Block: Customer Cohort Analysis            â”‚ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ â”‚ [Heatmap]                              â”‚ â”‚ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ â”‚                                        â”‚ â”‚ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚                                                  â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â”‚ Ask a question...                            [â†’]â”‚â”‚   â”‚
â”‚  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â”‚           â”‚  â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 Thread Interface

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  THREAD (CONVERSATION)                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  You: Show me revenue by customer segment                            â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Knosia: Here's revenue by segment for the last 12 months:     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  [Bar Chart: Revenue by Segment]                         â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                          â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Enterprise â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ $2.1M (52%)             â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  SMB        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ $1.2M (30%)                     â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Startup    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ $720K (18%)                          â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                          â”‚ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  Key insights:                                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ Enterprise grew 23% YoY                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ SMB is your fastest growing segment (+45% YoY)              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ Startup segment showing early signs of product-market fit   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  âœ“ 95% confidence â€¢ Sources: customers, subscriptions          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  [ğŸ“Œ Pin to Canvas] [ğŸ”„ Refresh] [ğŸ“¤ Export]                   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Suggested follow-ups:                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚ Drill into SMB   â”‚ â”‚ Compare to last  â”‚ â”‚ Show churn by    â”‚     â”‚  â”‚
â”‚  â”‚  â”‚ growth drivers   â”‚ â”‚ quarter          â”‚ â”‚ segment          â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Ask a question...                                               [â†’] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Implementation Phases

### Unified Metrics Table

| Phase | Priority | Days | LOC | Files | Depends On | Deliverable |
|-------|----------|------|-----|-------|------------|-------------|
| **Phase 0: Foundation** | P0 | 2 | 550 | 5 | None | Business type detection + templates |
| **Phase 1: Glue Code** | P0 | 2 | 700 | 4 | Phase 0 | UVBâ†’DB, Vocabâ†’SemanticLayer integration |
| **Phase 2: Onboarding** | P0 | 2 | 400 | 3 | Phase 1 | Enhanced onboarding flow with business type selection |
| **Phase 3: HOME & Canvas** | P0 | 4 | 600 | 6 | Phase 2 | Dashboard with KPIs (Canvas integration to HOME) |
| **Phase 4: Thread UI** | P1 | 3 | 400 | 4 | Phase 3 | Chat interface (backend ready) |
| **Phase 5: Polish** | P2 | 3 | - | Throughout | Phase 4 | Error handling, loading states, responsive CSS, E2E tests |
| **Total** | - | **16** | **2,650** | **22+** | - | - |

**Duration Rationale:** Phases 0-2 are foundational (6 days). Phase 3 integrates existing Canvas into HOME (4 days due to routing/state management). Phase 4 builds frontend for existing thread backend (3 days). Phase 5 is polish/testing (3 days).

### Phase 0: Foundation (Days 1-2) - P0

| Task | Description | Files | LOC |
|------|-------------|-------|-----|
| **Business Type Detector** | Pattern matching for SaaS, E-commerce, Marketplace, Custom | `packages/liquid-connect/src/business-types/detector.ts` | ~150 |
| **Business Type Signatures** | Detection patterns | `packages/liquid-connect/src/business-types/signatures.ts` | ~100 |
| **SaaS Template** | KPI definitions for SaaS | `packages/liquid-connect/src/business-types/catalog/saas.yaml` | ~150 |
| **Template Loader** | Load and parse templates | `packages/liquid-connect/src/business-types/catalog/loader.ts` | ~150 |

**Total:** ~550 LOC, 5 files

### Phase 1: Glue Code (Days 3-4) - P0

| Task | Description | Files | LOC |
|------|-------------|-------|-----|
| **saveDetectedVocabulary** | UVB â†’ knosia_vocabulary_item | `packages/api/src/modules/knosia/vocabulary/mutations.ts` | ~100 |
| **generateSemanticLayer** | ResolvedVocab â†’ SemanticLayer | `packages/liquid-connect/src/uvb/semantic-generator.ts` | ~150 |
| **generateDashboardSpec** | Template â†’ DashboardSpec | `packages/liquid-connect/src/dashboard/generator.ts` | ~150 |
| **dashboardSpecToLiquidSchema** | Spec â†’ LiquidSchema | `packages/liquid-render/src/dashboard/schema-generator.ts` | ~100 |
| **Pipeline Integration** | Connect glue functions to existing pipeline | `packages/api/src/modules/knosia/pipeline/` | ~200 |

**Total:** ~700 LOC, 4 files (+ pipeline updates)

### Phase 2: Onboarding Enhancement (Days 5-6) - P0

| Task | Description | Files | LOC |
|------|-------------|-------|-----|
| **Business Type Selection** | Add to review page | `apps/web/src/modules/onboarding/components/review/` | ~150 |
| **KPI Mapping Review** | Show detected KPIs | `apps/web/src/modules/onboarding/components/review/` | ~150 |
| **Multi-connection Support** | UI for adding connections (state already supports it) | `apps/web/src/modules/onboarding/components/connect/` | ~100 |

**Total:** ~400 LOC, 3 files

### Phase 3: HOME & Canvas (Days 7-10) - P0

| Task | Description | Files | LOC |
|------|-------------|-------|-----|
| **Home Page Route** | Briefing page | `apps/web/src/app/[locale]/dashboard/[org]/home/page.tsx` | ~50 |
| **Home Components** | KPI cards, charts | `apps/web/src/modules/knosia/home/` | ~300 |
| **Canvas Integration to HOME** | Integrate existing Canvas blocks into HOME dashboard | `apps/web/src/modules/knosia/home/` | ~150 |
| **Query Execution** | Connect vocabulary to queries | `apps/web/src/modules/knosia/hooks/` | ~100 |

**Total:** ~600 LOC, 6 files (Canvas module exists, needs HOME integration)

### Phase 4: Thread UI (Days 11-13) - P1

| Task | Description | Files | LOC |
|------|-------------|-------|-----|
| **Thread Page Route** | Chat interface page | `apps/web/src/app/[locale]/dashboard/[org]/thread/page.tsx` | ~50 |
| **Thread Components** | Message list, input, suggestions | `apps/web/src/modules/knosia/thread/` | ~250 |
| **API Integration** | Connect to existing thread backend | `apps/web/src/modules/knosia/hooks/` | ~100 |

**Total:** ~400 LOC, 4 files (backend already exists at `/thread` endpoint)

### Phase 5: Polish (Days 14-16) - P2

| Task | Description | Files |
|------|-------------|-------|
| **Error Handling** | Connection failures, query errors | Throughout |
| **Loading States** | Skeletons, progress | Throughout |
| **Responsive CSS** | Mobile-friendly layouts (CSS only, no separate mobile app) | Throughout |
| **E2E Tests** | Playwright tests | `apps/web/tests/` |

**Total:** Throughout codebase

---

## 7. Technical Specifications

### 7.1 Business Type Detection

```typescript
// packages/liquid-connect/src/business-types/types.ts

export type BusinessType =
  | "saas"
  | "ecommerce"
  | "marketplace"
  | "custom"        // V1 scope
  | "fintech"
  | "healthcare"
  | "edtech"
  | "media"
  | "logistics";    // V2 scope

export interface BusinessTypeMatch {
  type: BusinessType;
  confidence: number;      // 0-100
  signals: BusinessTypeSignal[];
  templateId: string;
}

export interface DetectionResult {
  matches: BusinessTypeMatch[];
  primary: BusinessTypeMatch | null;
  ambiguous: boolean;
}
```

### 7.2 Dashboard Spec

```typescript
// packages/liquid-connect/src/dashboard/types.ts

export interface DashboardSpec {
  businessType: string;
  title: string;
  sections: DashboardSection[];
  suggestedQuestions: string[];
}

export interface DashboardSection {
  name: string;
  kpis: DashboardKPI[];
  chart?: DashboardChart;
}

export interface DashboardKPI {
  id: string;
  name: string;
  binding: string;           // Field name for data binding
  format: 'currency' | 'percentage' | 'number';
  query: string;             // LC DSL query
  isFavorite?: boolean;
  suggestedForRole?: boolean;
}

export interface DashboardChart {
  type: 'line' | 'bar' | 'area' | 'pie';
  binding: string;
  xField: string;
  yField: string;
  name: string;
}
```

### 7.3 Glue Function Signatures

```typescript
// Save detected vocabulary to database
async function saveDetectedVocabulary(
  detected: DetectedVocabulary,
  orgId: string,
  workspaceId: string,
  options?: { promoteToOrg?: string[] }
): Promise<void>;

// Generate semantic layer from resolved vocabulary
async function generateSemanticLayerForUser(
  userId: string,
  workspaceId: string,
  schema: ExtractedSchema
): Promise<SemanticLayer>;

// Generate dashboard spec from business type + mappings
function generateDashboardSpec(
  mapping: MappingResult,
  template: BusinessTypeTemplate,
  resolved: ResolvedVocabulary,
  userRole?: string
): DashboardSpec;

// Convert dashboard spec to LiquidSchema
function dashboardSpecToLiquidSchema(
  spec: DashboardSpec
): LiquidSchema;
```

---

## 8. File Locations

**Reference:** See [1700-knosia-project-structure.md](.artifacts/2026-01-02-1700-knosia-project-structure.md) for complete file counts and directory structure.

### Existing Files (Reference)

| Component | Path |
|-----------|------|
| Knosia DB Schema | `packages/db/src/schema/knosia.ts` |
| Knosia API Router | `packages/api/src/modules/knosia/router.ts` |
| Vocabulary API | `packages/api/src/modules/knosia/vocabulary/` |
| Thread API | `packages/api/src/modules/knosia/thread/` |
| Activity API | `packages/api/src/modules/knosia/activity/` |
| Canvas API | `packages/api/src/modules/knosia/canvas/` |
| Comment API | `packages/api/src/modules/knosia/comment/` |
| Insight API | `packages/api/src/modules/knosia/insight/` |
| Notification API | `packages/api/src/modules/knosia/notification/` |
| Search API | `packages/api/src/modules/knosia/search/` |
| Pipeline Module | `packages/api/src/modules/knosia/pipeline/index.ts` |
| LiquidConnect Index | `packages/liquid-connect/src/index.ts` |
| UVB Module | `packages/liquid-connect/src/uvb/` (subpath import: `@repo/liquid-connect/uvb`) |
| LiquidRender Index | `packages/liquid-render/src/index.ts` |
| UI Compiler | `packages/liquid-render/src/compiler/ui-compiler.ts` |
| LiquidUI Component | `packages/liquid-render/src/renderer/LiquidUI.tsx` |
| Canvas Module | `apps/web/src/modules/knosia/canvas/` |
| Onboarding Module | `apps/web/src/modules/onboarding/` |

### New Files (To Create)

| Component | Path |
|-----------|------|
| Business Type Detector | `packages/liquid-connect/src/business-types/detector.ts` |
| Business Type Signatures | `packages/liquid-connect/src/business-types/signatures.ts` |
| Business Type Types | `packages/liquid-connect/src/business-types/types.ts` |
| Template Loader | `packages/liquid-connect/src/business-types/catalog/loader.ts` |
| SaaS Template | `packages/liquid-connect/src/business-types/catalog/saas.yaml` |
| Template Mapper | `packages/liquid-connect/src/business-types/mapper.ts` |
| Semantic Generator | `packages/liquid-connect/src/uvb/semantic-generator.ts` |
| Dashboard Generator | `packages/liquid-connect/src/dashboard/generator.ts` |
| Schema Generator | `packages/liquid-render/src/dashboard/schema-generator.ts` |
| Home Page | `apps/web/src/app/[locale]/dashboard/[org]/home/page.tsx` |
| Home Components | `apps/web/src/modules/knosia/home/` |

---

## Summary

**What we have:** Complete data-to-UI pipeline (13,000+ LOC)
**What we need:** Glue code to connect the pieces (~700 LOC core, ~1,250 LOC full layer, ~2,650 LOC complete)
**Timeline:** 16 days to MVP (see unified metrics table above)
**Leverage ratio:** 18:1 (existing vs new code for core glue)

The architecture scales from analytics platform to full zero-code business management through:
- DSL-based extensibility (LiquidCode supports mutations, workflows)
- 3-level vocabulary governance (org/workspace/user with private vocabulary)
- Semantic layer abstraction (entities, relationships, rules)
- Component-based UI (77 types, extensible)

---

*End of Consolidated Implementation Plan*
